---
title: "Sales Data"
author: "Hamdan Sulaiman"
date: "2023-09-27"
output: 
  html_document:
    df_print: paged
    theme:
      version: 4
      bootswatch: yeti
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: false
    toc_depth: 3
    number_sections: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, #whether to show code chunks
  message = FALSE, #whether to show messages from code
  warning = FALSE, #whether to show warnings from code
  fig.width = 8, #figure width in inches
  fig.height = 5, #figure height in inches
  out.width = "50%" #figures span 50% of the pages width
  )
library(tidyverse)
library(kableExtra)
library(gridExtra)
```

```{r}
#Read data from file
sales_local <- read_csv("data/sales_data_sample.csv")
```
```{r}
# Keep only the data for planes, motorcycles and cars
sales_pmc <- filter(sales_local, PRODUCTLINE %in% c("Planes", "Motorcycles", "Classic Cars"))
# Count how many are in each PRODUCTLINE
sales_counts <- count(sales_pmc, PRODUCTLINE)
```
## Sample Sales Report

This report summarizes the sales data for different types of vehicles sold between 2003 and 2005. This data is from [Kaggle](https://www.kaggle.com/kyanyoga/sample-sales-data).


### Written summary of the Sales by Type

The total number of **planes** sold was `r sales_counts$n[3]`

The total number of **motorcycles** sold was `r sales_counts$n[2]`

The total number of **classic cars** sold was `r sales_counts$n[1]`.

### Graphical Summary of the Sales by Type
<div class="row">
<div class="col-md-6">
```{r}
k <- kable(sales_counts, 
      col.names = c("Product", "Sales"),
      caption = "Number of sales per product line.", 
      align = "c")
k_style <- kable_classic(k, full_width = FALSE) 
k_highlighted <- row_spec(k_style, row = 0, bold = TRUE, color = "blue") 
k_highlighted
```
</div>
<div class="col-md-6">
```{r, fig.width = 10, fig.height = 10}
#Simple bar chart that represents the sales data 
ggplot(data = sales_counts, 
       mapping = aes(x = PRODUCTLINE,
                     y = n,
                     fill = PRODUCTLINE)) +
      geom_col(show.legend = FALSE) +
      labs(x = "Type of vehicle",
           y = "Number of sales",
           title = "Sales of Vehicle Type",
           subtitle = "2003 - 2005")
```
</div>
</div>
